"use strict";(self.webpackChunkappdemo_ng12=self.webpackChunkappdemo_ng12||[]).push([[996],{6996:function(t,e,i){i.r(e),i.d(e,{PointModule:function(){return _t}});var n=i(2224),r=i(8127),s=i(30),o=i(7147);let u=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-point-layout"]],decls:1,vars:0,template:function(t,e){1&t&&o._UZ(0,"router-outlet")},directives:[s.lC],styles:[""]}),t})();var d=i(7112),g=i(5688),a=i(4693),l=i.n(a),Z=i(1037),c=i(8054),p=i(514),T=i(1569);function A(t,e){if(1&t&&(o.TgZ(0,"option",25),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.s9C("value",t.GROUP_POINT_ID),o.xp6(1),o.Oqu(t.GROUP_POINT_NAME)}}function h(t,e){1&t&&(o.TgZ(0,"span"),o._UZ(1,"i",32),o.qZA())}function f(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"tr"),o.TgZ(1,"td",26),o.TgZ(2,"p"),o._uU(3),o.qZA(),o.qZA(),o.TgZ(4,"td",26),o.TgZ(5,"p"),o._uU(6),o.qZA(),o.qZA(),o.TgZ(7,"td",26),o.TgZ(8,"p"),o._uU(9),o.qZA(),o.qZA(),o.TgZ(10,"td",26),o.TgZ(11,"p"),o._uU(12),o.qZA(),o.qZA(),o.TgZ(13,"td",26),o.TgZ(14,"p"),o._uU(15),o.qZA(),o.qZA(),o.TgZ(16,"td",26),o.TgZ(17,"p"),o._uU(18),o.qZA(),o.qZA(),o.TgZ(19,"td"),o.TgZ(20,"div",27),o.TgZ(21,"button",28),o._UZ(22,"i",29),o.qZA(),o._uU(23,"\xa0 "),o.TgZ(24,"button",30),o.NdJ("click",function(){const e=o.CHM(t).$implicit;return o.oxw().confirmBox("delete",e)}),o.YNc(25,h,2,0,"span",31),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=o.oxw();o.xp6(3),o.Oqu(i+1),o.xp6(3),o.Oqu(t.POINT_CATEGORY_NAME),o.xp6(3),o.Oqu(t.TABLE_SOURCE),o.xp6(3),o.Oqu(t.TARGET),o.xp6(3),o.Oqu(t.PERCENTAGE),o.xp6(3),o.Oqu(t.GROUP_POINT_NAME),o.xp6(3),o.cQ8("routerLink","edit/",t.POINT_ID,"/",n.group_point_id,"/",n.group_point_name,""),o.xp6(3),o.Q6J("disabled",t.isDeleting),o.xp6(1),o.Q6J("ngIf",!t.isDeleting)}}function q(t,e){if(1&t&&(o.TgZ(0,"tr"),o.TgZ(1,"td",26),o.TgZ(2,"p"),o._uU(3),o.qZA(),o.qZA(),o.qZA()),2&t){const t=e.$implicit;o.xp6(3),o.Oqu(t.GROUP_POINT_NAME)}}function _(t,e){1&t&&(o.TgZ(0,"span"),o._UZ(1,"i",32),o.qZA())}function m(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"tr"),o.TgZ(1,"td",26),o.TgZ(2,"p"),o._uU(3),o.qZA(),o.qZA(),o.TgZ(4,"td",26),o.TgZ(5,"p"),o._uU(6),o.qZA(),o.qZA(),o.TgZ(7,"td",26),o.TgZ(8,"p"),o._uU(9),o.qZA(),o.qZA(),o.TgZ(10,"td",26),o.TgZ(11,"p"),o._uU(12),o.qZA(),o.qZA(),o.TgZ(13,"td"),o.TgZ(14,"div",33),o._UZ(15,"img",34),o.qZA(),o.qZA(),o.TgZ(16,"td"),o.TgZ(17,"div",27),o.TgZ(18,"button",28),o._UZ(19,"i",29),o.qZA(),o._uU(20,"\xa0 "),o.TgZ(21,"button",30),o.NdJ("click",function(){const e=o.CHM(t).$implicit;return o.oxw().confirmBox("deletebadge",e)}),o.YNc(22,_,2,0,"span",31),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=o.oxw();o.xp6(3),o.Oqu(i+1),o.xp6(3),o.Oqu(t.BADGE_NAME),o.xp6(3),o.Oqu(t.START_POINT),o.xp6(3),o.Oqu(t.END_POINT),o.xp6(3),o.s9C("src",n.apiurl+t.PICTURE,o.LSH),o.xp6(3),o.MGl("routerLink","editbadge/",t.BADGE_ID,""),o.xp6(3),o.Q6J("disabled",t.isDeleting),o.xp6(1),o.Q6J("ngIf",!t.isDeleting)}}let v=(()=>{class t{constructor(t,e,i){this.pointService=t,this.groupPoint=e,this.alertService=i,this.subs=new g.Y,this.point=null,this.badge=null,this.group_point=null,this.group_point_id=null,this.group_point_name=null,this.apiurl=Z.N.apiUrl+"/image/"}ngOnInit(){this.subs.add(this.pointService.getAllbadge().pipe((0,d.P)()).subscribe(t=>this.badge=t)),this.subs.add(this.groupPoint.getAll().subscribe(t=>{this.group_point=t,this.group_point_id=t[0].GROUP_POINT_ID,this.group_point_name=t[0].GROUP_POINT_NAME,this.subs.add(this.pointService.getByGroup(this.group_point_id).pipe((0,d.P)()).subscribe(t=>this.point=t))}))}delete(t){this.alertService.loading();const e=this.point.find(e=>e.POINT_ID===t.POINT_ID);this.subs.add(this.pointService.delete(t.POINT_ID).pipe((0,d.P)()).subscribe(()=>{e.isDeleting=!0,this.point=this.point.filter(e=>e.POINT_ID!==t.POINT_ID),this.alertService.success()},t=>{this.alertService.error(t)}))}deletebadge(t){this.alertService.loading();const e=this.badge.find(e=>e.BADGE_ID===t.BADGE_ID);this.subs.add(this.pointService.deletebadge(t.BADGE_ID).pipe((0,d.P)()).subscribe(()=>{e.isDeleting=!0,this.badge=this.badge.filter(e=>e.BADGE_ID!==t.BADGE_ID),this.alertService.success()},t=>{this.alertService.error(t)}))}onSelectClick(t){this.group_point_id=t,this.group_point_name=this.group_point.filter(e=>e.GROUP_POINT_ID===parseInt(t))[0].GROUP_POINT_NAME,this.subs.add(this.pointService.getByGroup(t).pipe((0,d.P)()).subscribe(t=>this.point=t))}confirmBox(t,e){let i;"delete"==t&&(i=e.POINT_CATEGORY_NAME),"deletebadge"==t&&(i=e.BADGE_NAME),l().fire({title:"Are you sure want to delete?",text:i,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(i=>{i.value&&("delete"==t&&this.delete(e),"deletebadge"==t&&this.deletebadge(e))})}ngOnDestroy(){this.subs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(c.H),o.Y36(p.T),o.Y36(T.c9))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-point"]],decls:93,vars:6,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],[1,"mr-40"],[1,"row"],[1,"col-lg-9"],[1,"card-style","mb-30"],[1,"title","d-flex","flex-wrap","justify-content-between"],[1,"main-btn","primary-btn","btn-hover","btn-sm",3,"routerLink"],[1,"lni","lni-plus","mr-5"],[1,"left"],[1,"text-medium","mb-10"],[1,"right"],[1,"select-style-1"],[1,"select-position","select-sm"],[1,"light-bg",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"table-wrapper","table-responsive"],[1,"table","striped-table"],[4,"ngFor","ngForOf"],[1,"col-lg-3"],["routerLink","addbadge",1,"main-btn","primary-btn","btn-hover","btn-sm"],[1,"tables-wrapper"],[1,"col-lg-12"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"table"],[3,"value"],[1,"min-width"],[1,"action"],[1,"text-primary",2,"cursor","pointer",3,"routerLink"],[1,"lni","lni-pencil-alt"],[1,"text-danger",3,"disabled","click"],[4,"ngIf"],[1,"lni","lni-trash-can"],[1,"employee-image"],["alt","",3,"src"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"h2",1),o._uU(2,"Point Management"),o.qZA(),o.qZA(),o.TgZ(3,"div",2),o.TgZ(4,"div",3),o.TgZ(5,"div",4),o.TgZ(6,"div",5),o.TgZ(7,"button",6),o._UZ(8,"i",7),o._uU(9,"New Point"),o.qZA(),o.TgZ(10,"div",8),o.TgZ(11,"h6",9),o._uU(12,"Point PerGroup"),o.qZA(),o.qZA(),o.TgZ(13,"div",10),o.TgZ(14,"div",11),o.TgZ(15,"div",12),o.TgZ(16,"select",13),o.NdJ("change",function(t){return e.onSelectClick(t.target.value)}),o.YNc(17,A,2,2,"option",14),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o._UZ(18,"br"),o.TgZ(19,"div",15),o.TgZ(20,"table",16),o.TgZ(21,"thead"),o.TgZ(22,"tr"),o.TgZ(23,"th"),o.TgZ(24,"h6"),o._uU(25,"#"),o.qZA(),o.qZA(),o.TgZ(26,"th"),o.TgZ(27,"h6"),o._uU(28,"Point Name"),o.qZA(),o.qZA(),o.TgZ(29,"th"),o.TgZ(30,"h6"),o._uU(31,"Source Table"),o.qZA(),o.qZA(),o.TgZ(32,"th"),o.TgZ(33,"h6"),o._uU(34,"Target"),o.qZA(),o.qZA(),o.TgZ(35,"th"),o.TgZ(36,"h6"),o._uU(37,"%"),o.qZA(),o.qZA(),o.TgZ(38,"th"),o.TgZ(39,"h6"),o._uU(40,"Group"),o.qZA(),o.qZA(),o.TgZ(41,"th"),o.TgZ(42,"h6"),o._uU(43,"Action"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(44,"tbody"),o.YNc(45,f,26,11,"tr",17),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(46,"div",18),o.TgZ(47,"div",4),o.TgZ(48,"div",15),o.TgZ(49,"table",16),o.TgZ(50,"thead"),o.TgZ(51,"tr"),o.TgZ(52,"th"),o.TgZ(53,"h6"),o._uU(54,"Group Name"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(55,"tbody"),o.YNc(56,q,4,1,"tr",17),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(57,"div",0),o.TgZ(58,"h2",1),o._uU(59,"Badge Management"),o.qZA(),o.TgZ(60,"button",19),o._UZ(61,"i",7),o._uU(62,"New Badge"),o.qZA(),o.qZA(),o.TgZ(63,"div",20),o.TgZ(64,"div",2),o.TgZ(65,"div",21),o.TgZ(66,"div",4),o.TgZ(67,"div",22),o._UZ(68,"div",23),o.qZA(),o.TgZ(69,"div",15),o.TgZ(70,"table",24),o.TgZ(71,"thead"),o.TgZ(72,"tr"),o.TgZ(73,"th"),o.TgZ(74,"h6"),o._uU(75,"#"),o.qZA(),o.qZA(),o.TgZ(76,"th"),o.TgZ(77,"h6"),o._uU(78,"Badge Name"),o.qZA(),o.qZA(),o.TgZ(79,"th"),o.TgZ(80,"h6"),o._uU(81,"Start Point"),o.qZA(),o.qZA(),o.TgZ(82,"th"),o.TgZ(83,"h6"),o._uU(84,"End Point"),o.qZA(),o.qZA(),o.TgZ(85,"th"),o.TgZ(86,"h6"),o._uU(87,"Image"),o.qZA(),o.qZA(),o.TgZ(88,"th"),o.TgZ(89,"h6"),o._uU(90,"Action"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(91,"tbody"),o.YNc(92,m,23,8,"tr",17),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(7),o.hYB("routerLink","add/",e.group_point_id,"/",e.group_point_name,""),o.xp6(10),o.Q6J("ngForOf",e.group_point),o.xp6(28),o.Q6J("ngForOf",e.point),o.xp6(11),o.Q6J("ngForOf",e.group_point),o.xp6(36),o.Q6J("ngForOf",e.badge))},directives:[s.rH,n.sg,r.YN,r.Kr,n.O5],styles:[""]}),t})();var b=i(7755);function N(t,e){1&t&&(o.TgZ(0,"h2",20),o._uU(1,"New Point"),o.qZA())}function I(t,e){1&t&&(o.TgZ(0,"h2",20),o._uU(1,"Edit Point"),o.qZA())}function E(t,e){1&t&&(o.TgZ(0,"div"),o._uU(1,"*group point required"),o.qZA())}function U(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,E,2,0,"div",12),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.Q6J("ngIf",t.f.GROUP_POINT_NAME.errors.required)}}const P=function(t){return{"is-invalid":t}};function x(t,e){if(1&t&&(o.TgZ(0,"div",10),o.TgZ(1,"label"),o._uU(2,"Group Point"),o.qZA(),o._UZ(3,"input",21),o.YNc(4,U,2,1,"div",12),o.qZA()),2&t){const t=o.oxw();o.xp6(3),o.Q6J("ngClass",o.VKq(2,P,t.submitted&&t.f.GROUP_POINT_NAME.errors)),o.xp6(1),o.Q6J("ngIf",t.submitted&&t.f.GROUP_POINT_NAME.errors)}}function O(t,e){if(1&t&&(o.TgZ(0,"option",26),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.s9C("value",t.GROUP_POINT_ID),o.xp6(1),o.Oqu(t.GROUP_POINT_NAME)}}function C(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*group point required"),o.qZA())}function S(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,C,2,0,"div",27),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.Q6J("ngIf",t.f.GROUP_POINT_ID.errors.required)}}function Y(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",22),o.TgZ(1,"label"),o._uU(2,"Group Point"),o.qZA(),o.TgZ(3,"div",23),o.TgZ(4,"select",24),o.NdJ("change",function(e){return o.CHM(t),o.oxw().onSelectClick(e.target.value)}),o.YNc(5,O,2,2,"option",25),o.qZA(),o.qZA(),o.YNc(6,S,2,1,"div",12),o.qZA()}if(2&t){const t=o.oxw();o.xp6(4),o.Q6J("ngClass",o.VKq(3,P,t.submitted&&t.f.GROUP_POINT_ID.errors)),o.xp6(1),o.Q6J("ngForOf",t.group_point),o.xp6(1),o.Q6J("ngIf",t.submitted&&t.f.GROUP_POINT_ID.errors)}}function R(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*Point Name required"),o.qZA())}function G(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,R,2,0,"div",27),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.POINT_CATEGORY_NAME.errors.required)}}function J(t,e){1&t&&(o.TgZ(0,"div",10),o.TgZ(1,"label"),o._uU(2,"Source Table"),o.qZA(),o._UZ(3,"input",29),o.qZA())}function y(t,e){if(1&t&&(o.TgZ(0,"option",26),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.s9C("value",t.TABLE_NAME),o.xp6(1),o.Oqu(t.TABLE_NAME)}}function w(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*table required"),o.qZA())}function Q(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,w,2,0,"div",27),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.Q6J("ngIf",t.f.TABLE_SOURCE.errors.required)}}function M(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",22),o.TgZ(1,"label"),o._uU(2,"Source Table"),o.qZA(),o.TgZ(3,"div",23),o.TgZ(4,"select",30),o.NdJ("change",function(e){return o.CHM(t),o.oxw().onSelectClickTable(e.target.value)}),o.YNc(5,y,2,2,"option",25),o.qZA(),o.qZA(),o.YNc(6,Q,2,1,"div",12),o.qZA()}if(2&t){const t=o.oxw();o.xp6(4),o.Q6J("ngClass",o.VKq(3,P,t.submitted&&t.f.TABLE_SOURCE.errors)),o.xp6(1),o.Q6J("ngForOf",t.gettable),o.xp6(1),o.Q6J("ngIf",t.submitted&&t.f.TABLE_SOURCE.errors)}}function B(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*target required"),o.qZA())}function D(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,B,2,0,"div",27),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.TARGET.errors.required)}}function F(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*required"),o.qZA())}function k(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*max 100"),o.qZA())}function L(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,F,2,0,"div",27),o.YNc(2,k,2,0,"div",27),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.Q6J("ngIf",t.f.PERCENTAGE.errors.required),o.xp6(1),o.Q6J("ngIf",t.f.PERCENTAGE.errors.max)}}function V(t,e){1&t&&(o.TgZ(0,"div",28),o._uU(1,"*melebihi total Percentage"),o.qZA())}function K(t,e){if(1&t&&(o.TgZ(0,"div",10),o.TgZ(1,"label"),o._uU(2,"Percentage"),o.qZA(),o._UZ(3,"input",31),o.YNc(4,L,3,2,"div",12),o.YNc(5,V,2,0,"div",27),o.qZA()),2&t){const t=o.oxw();o.xp6(3),o.Q6J("ngClass",o.VKq(3,P,t.submitted&&t.f.PERCENTAGE.errors)),o.xp6(1),o.Q6J("ngIf",t.submitted&&t.f.PERCENTAGE.errors),o.xp6(1),o.Q6J("ngIf",t.pass)}}function H(t,e){1&t&&(o.TgZ(0,"div",10),o.TgZ(1,"label"),o._uU(2,"Percentage"),o.qZA(),o._UZ(3,"input",32),o.qZA())}function $(t,e){1&t&&o._UZ(0,"span")}function j(t,e){if(1&t&&(o.TgZ(0,"tr"),o.TgZ(1,"td",33),o.TgZ(2,"p"),o._uU(3),o.qZA(),o.qZA(),o.TgZ(4,"td",33),o.TgZ(5,"p"),o._uU(6),o.qZA(),o.qZA(),o.TgZ(7,"td",33),o.TgZ(8,"p"),o._uU(9),o.qZA(),o.qZA(),o.TgZ(10,"td",33),o.TgZ(11,"p"),o._uU(12),o.qZA(),o.qZA(),o.qZA()),2&t){const t=e.$implicit;o.xp6(3),o.Oqu(t.POINT_CATEGORY_NAME),o.xp6(3),o.Oqu(t.TABLE_SOURCE),o.xp6(3),o.Oqu(t.MAX_POINT),o.xp6(3),o.hij("",t.PERCENTAGE," %")}}let X=(()=>{class t{constructor(t,e,i,n,r,s,o){this.formBuilder=t,this.route=e,this.router=i,this.pointService=n,this.alertService=r,this.groupPoint=s,this.queryviewService=o,this.subs=new g.Y,this.loading=!1,this.submitted=!1,this.data=null,this.gettable=null,this.point=null,this.totalpercentage=0,this.pass=!1,this.temp=0,this.group_point=null,this.groupid=null,this.groupname=null,this.queryviewdata=null,this.type_queryview=null}ngOnInit(){this.id=this.route.snapshot.params.id,this.groupid=this.route.snapshot.params.groupid,this.groupname=this.route.snapshot.params.groupname,this.isAddMode=!this.id,this.form=this.formBuilder.group({POINT_CATEGORY_NAME:["",r.kI.required],TARGET:["",r.kI.required],PERCENTAGE:["",r.kI.required],TABLE_SOURCE:["",r.kI.required],GROUP_POINT_ID:[this.groupid],GROUP_POINT_NAME:[this.groupname]}),this.subs.add(this.queryviewService.getAll().subscribe(t=>this.queryviewdata=t)),this.isAddMode||this.subs.add(this.pointService.getById(this.id).pipe((0,d.P)()).subscribe(t=>{this.form.patchValue(t),this.temp=parseInt(t.PERCENTAGE),this.type_queryview=this.queryviewdata.find(e=>e.QUERY_VIEW_NAME==t.TABLE_SOURCE).TYPE_ID})),this.subs.add(this.pointService.getAlltable(this.groupid).subscribe(t=>this.gettable=t)),this.subs.add(this.pointService.getByGroup(this.groupid).pipe((0,d.P)()).subscribe(t=>{void 0===t||0==t.length?this.point=null:(this.totalpercentage=t.map(t=>parseInt(t.PERCENTAGE)).reduce(function(t,e){return t+e}),this.point=t)})),this.subs.add(this.groupPoint.getAll().subscribe(t=>this.group_point=t))}get f(){return this.form.controls}onSubmit(){if(this.isAddMode){if(this.totalpercentage+this.form.value.PERCENTAGE>=100)return void(this.pass=!0);this.pass=!1}else{if(this.totalpercentage-this.temp+parseInt(this.form.value.PERCENTAGE)>=100)return void(this.pass=!0);this.pass=!1}this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.create():this.update())}create(){this.alertService.loading(),this.subs.add(this.pointService.create(this.form.value).pipe((0,d.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["/point"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}update(){this.alertService.loading(),this.subs.add(this.pointService.update(this.id,this.form.value).pipe((0,d.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["/point"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}onSelectClick(t){const e=this.group_point.filter(e=>e.GROUP_POINT_ID===parseInt(t))[0].GROUP_POINT_NAME;this.form.get("GROUP_POINT_NAME").setValue(e),this.subs.add(this.pointService.getAlltable(t).subscribe(t=>this.gettable=t)),this.subs.add(this.pointService.getByGroup(t).pipe((0,d.P)()).subscribe(t=>{void 0===t||0==t.length?(this.point=null,this.form.get("TABLE_SOURCE").setValue("")):(this.totalpercentage=t.map(t=>parseInt(t.PERCENTAGE)).reduce(function(t,e){return t+e}),this.point=t)}))}onSelectClickTable(t){this.type_queryview=this.queryviewdata.find(e=>e.QUERY_VIEW_NAME==t).TYPE_ID,2==parseInt(this.type_queryview)?this.form.get("PERCENTAGE").setValue("0"):this.form.get("PERCENTAGE").setValue("")}ngOnDestroy(){this.subs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.qu),o.Y36(s.gz),o.Y36(s.F0),o.Y36(c.H),o.Y36(T.c9),o.Y36(p.T),o.Y36(b.b))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-point-add-edit"]],decls:57,vars:21,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],["class","mr-40",4,"ngIf"],["routerLink","/point",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[1,"col-lg-6"],[1,"card-style","mb-30"],[3,"formGroup","ngSubmit"],["class","input-style-1",4,"ngIf"],["class","select-style-1",4,"ngIf"],[1,"input-style-1"],["type","text","formControlName","POINT_CATEGORY_NAME",3,"ngClass"],[4,"ngIf"],["type","number","formControlName","TARGET","min","0",3,"ngClass"],[1,"divider"],[1,"main-btn","primary-btn","rounded-btn","btn-hover",3,"disabled"],[1,"mb-10"],[1,"table-wrapper","table-responsive"],[1,"table","striped-table"],[4,"ngFor","ngForOf"],[1,"mr-40"],["type","text","formControlName","GROUP_POINT_NAME","disabled","",3,"ngClass"],[1,"select-style-1"],[1,"select-position"],["formControlName","GROUP_POINT_ID",3,"ngClass","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["style","color:red",4,"ngIf"],[2,"color","red"],["type","text","formControlName","TABLE_SOURCE","disabled",""],["formControlName","TABLE_SOURCE",3,"ngClass","change"],["type","number","formControlName","PERCENTAGE","min","0","max","100",3,"ngClass"],["type","number","formControlName","PERCENTAGE","min","0","max","100","disabled",""],[1,"min-width"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.YNc(1,N,2,0,"h2",1),o.YNc(2,I,2,0,"h2",1),o.TgZ(3,"button",2),o._UZ(4,"i",3),o._uU(5,"Back"),o.qZA(),o.qZA(),o.TgZ(6,"div",4),o.TgZ(7,"div",5),o.TgZ(8,"div",6),o.TgZ(9,"form",7),o.NdJ("ngSubmit",function(){return e.onSubmit()}),o.YNc(10,x,5,4,"div",8),o.YNc(11,Y,7,5,"div",9),o.TgZ(12,"div",10),o.TgZ(13,"label"),o._uU(14,"Point Name"),o.qZA(),o._UZ(15,"input",11),o.YNc(16,G,2,1,"div",12),o.qZA(),o.YNc(17,J,4,0,"div",8),o.YNc(18,M,7,5,"div",9),o.TgZ(19,"div",10),o.TgZ(20,"label"),o._uU(21,"Target Point"),o.qZA(),o._UZ(22,"input",13),o.YNc(23,D,2,1,"div",12),o.qZA(),o.YNc(24,K,6,5,"div",8),o.YNc(25,H,4,0,"div",8),o.TgZ(26,"span",14),o._UZ(27,"hr"),o.qZA(),o.TgZ(28,"div"),o.TgZ(29,"button",2),o._uU(30," Cancel "),o.qZA(),o._uU(31,"\xa0 "),o.TgZ(32,"button",15),o.YNc(33,$,1,0,"span",12),o._uU(34," \xa0Save\xa0 "),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(35,"div",5),o.TgZ(36,"div",6),o.TgZ(37,"h6",16),o._uU(38),o.qZA(),o.TgZ(39,"div",17),o.TgZ(40,"table",18),o.TgZ(41,"thead"),o.TgZ(42,"tr"),o.TgZ(43,"th"),o.TgZ(44,"h6"),o._uU(45,"Point Name"),o.qZA(),o.qZA(),o.TgZ(46,"th"),o.TgZ(47,"h6"),o._uU(48,"Source Table"),o.qZA(),o.qZA(),o.TgZ(49,"th"),o.TgZ(50,"h6"),o._uU(51,"Max Point"),o.qZA(),o.qZA(),o.TgZ(52,"th"),o.TgZ(53,"h6"),o._uU(54,"Percent %"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(55,"tbody"),o.YNc(56,j,13,4,"tr",19),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(1),o.Q6J("ngIf",e.isAddMode),o.xp6(1),o.Q6J("ngIf",!e.isAddMode),o.xp6(7),o.Q6J("formGroup",e.form),o.xp6(1),o.Q6J("ngIf",!e.isAddMode),o.xp6(1),o.Q6J("ngIf",e.isAddMode),o.xp6(4),o.Q6J("ngClass",o.VKq(17,P,e.submitted&&e.f.POINT_CATEGORY_NAME.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.POINT_CATEGORY_NAME.errors),o.xp6(1),o.Q6J("ngIf",!e.isAddMode),o.xp6(1),o.Q6J("ngIf",e.isAddMode),o.xp6(4),o.Q6J("ngClass",o.VKq(19,P,e.submitted&&e.f.TARGET.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.TARGET.errors),o.xp6(1),o.Q6J("ngIf",1===e.type_queryview),o.xp6(1),o.Q6J("ngIf",2===e.type_queryview),o.xp6(7),o.Q6J("disabled",e.loading),o.xp6(1),o.Q6J("ngIf",e.loading),o.xp6(5),o.hij("Total Percentage : ",e.totalpercentage,"%"),o.xp6(18),o.Q6J("ngForOf",e.point))},directives:[n.O5,s.rH,r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,n.mk,r.wV,r.qQ,n.sg,r.EJ,r.YN,r.Kr,r.Fd],styles:[""]}),t})();var z=i(3546);function W(t,e){1&t&&(o.TgZ(0,"h2",19),o._uU(1,"New Badge"),o.qZA())}function tt(t,e){1&t&&(o.TgZ(0,"h2",19),o._uU(1,"Edit Badge"),o.qZA())}function et(t,e){1&t&&(o.TgZ(0,"div",21),o._uU(1,"*Badge Name required"),o.qZA())}function it(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,et,2,0,"div",20),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.BADGE_NAME.errors.required)}}function nt(t,e){1&t&&(o.TgZ(0,"div",21),o._uU(1,"*Start Point required"),o.qZA())}function rt(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,nt,2,0,"div",20),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.START_POINT.errors.required)}}function st(t,e){1&t&&(o.TgZ(0,"div",21),o._uU(1,"*End Point required"),o.qZA())}function ot(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,st,2,0,"div",20),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.END_POINT.errors.required)}}function ut(t,e){1&t&&(o.TgZ(0,"div",27),o._UZ(1,"div",28),o.qZA())}function dt(t,e){1&t&&(o.TgZ(0,"div",29),o._uU(1," Image Uploaded Succesfuly!"),o.qZA())}function gt(t,e){1&t&&(o.TgZ(0,"div",30),o._uU(1," Image Upload Failed!"),o.qZA())}const at=function(t){return{"background-image":t}};function lt(t,e){if(1&t&&(o.TgZ(0,"div",22),o._UZ(1,"div",23),o.YNc(2,ut,2,0,"div",24),o.YNc(3,dt,2,0,"div",25),o.YNc(4,gt,2,0,"div",26),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Gre("img-preview","fail"===t.selectedFile.status?"-error":"",""),o.Q6J("ngStyle",o.VKq(7,at,"url("+t.selectedFile.src+")")),o.xp6(1),o.Q6J("ngIf",t.selectedFile.pending),o.xp6(1),o.Q6J("ngIf","ok"===t.selectedFile.status),o.xp6(1),o.Q6J("ngIf","fail"===t.selectedFile.status)}}function Zt(t,e){1&t&&(o.TgZ(0,"div",21),o._uU(1,"*Picture required"),o.qZA())}function ct(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,Zt,2,0,"div",20),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.f.PICTURE.errors.required)}}function pt(t,e){1&t&&o._UZ(0,"span")}const Tt=function(t){return{"is-invalid":t}};class At{constructor(t,e){this.src=t,this.file=e,this.pending=!1,this.status="init"}}let ht=(()=>{class t{constructor(t,e,i,n,r,s){this.formBuilder=t,this.route=e,this.router=i,this.pointService=n,this.alertService=r,this.imageService=s,this.subs=new g.Y,this.loading=!1,this.submitted=!1,this.data=null,this.apiurl=Z.N.apiUrl,this.filenameimage=null}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({BADGE_NAME:["",r.kI.required],START_POINT:["",r.kI.required],END_POINT:["",r.kI.required],PICTURE:[""]}),this.isAddMode||this.subs.add(this.pointService.getByIdbadge(this.id).pipe((0,d.P)()).subscribe(t=>this.form.patchValue(t)))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.create():this.update())}create(){this.alertService.loading(),this.subs.add(this.pointService.createbadge(this.form.value).pipe((0,d.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}update(){this.alertService.loading(),this.subs.add(this.pointService.updatebadge(this.id,this.form.value).pipe((0,d.P)()).subscribe({next:()=>{this.alertService.success(),this.router.navigate(["../../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}onSuccess(){this.selectedFile.pending=!1,this.selectedFile.status="ok"}onError(){this.selectedFile.pending=!1,this.selectedFile.status="fail",this.selectedFile.src=""}processFile(t){const e=t.files[0],i=new FileReader;this.form.value.PICTURE&&this.imageService.deleteImage(this.form.value.PICTURE).pipe((0,d.P)()).subscribe(),i.addEventListener("load",t=>{this.selectedFile=new At(t.target.result,e),this.imageService.uploadImage(this.selectedFile.file).subscribe(t=>{this.form.get("PICTURE").setValue(t.filename),this.onSuccess()},t=>{this.onError()})}),i.readAsDataURL(e)}ngOnDestroy(){this.subs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.qu),o.Y36(s.gz),o.Y36(s.F0),o.Y36(c.H),o.Y36(T.c9),o.Y36(z.C))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-badge-add-edit"]],decls:49,vars:22,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],["class","mr-40",4,"ngIf"],["routerLink","/point",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"col-lg-6"],[1,"card-style","mb-30"],[1,"divider"],[1,"input-style-1"],["type","text","formControlName","BADGE_NAME",3,"ngClass"],[4,"ngIf"],["type","number","formControlName","START_POINT",3,"ngClass"],["type","number","formControlName","END_POINT",3,"ngClass"],["type","file","accept","image/*",3,"change"],["imageInput",""],["class","img-preview-container",4,"ngIf"],["type","text","formControlName","PICTURE","disabled","",3,"ngClass"],[1,"main-btn","primary-btn","rounded-btn","btn-hover",3,"disabled"],[1,"mr-40"],["style","color:red",4,"ngIf"],[2,"color","red"],[1,"img-preview-container"],[3,"ngStyle"],["class","img-loading-overlay",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"img-loading-overlay"],[1,"img-spinning-circle"],[1,"alert","alert-success"],[1,"alert","alert-danger"]],template:function(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",0),o.YNc(1,W,2,0,"h2",1),o.YNc(2,tt,2,0,"h2",1),o.TgZ(3,"button",2),o._UZ(4,"i",3),o._uU(5,"Back"),o.qZA(),o.qZA(),o.TgZ(6,"div",4),o.TgZ(7,"form",5),o.NdJ("ngSubmit",function(){return e.onSubmit()}),o.TgZ(8,"div",6),o.TgZ(9,"div",7),o.TgZ(10,"h5"),o._uU(11,"Badge Description"),o.qZA(),o.TgZ(12,"span",8),o._UZ(13,"hr"),o.qZA(),o.TgZ(14,"div",9),o.TgZ(15,"label"),o._uU(16,"Badge Name"),o.qZA(),o._UZ(17,"input",10),o.YNc(18,it,2,1,"div",11),o.qZA(),o.TgZ(19,"div",9),o.TgZ(20,"label"),o._uU(21,"Start Point"),o.qZA(),o._UZ(22,"input",12),o.YNc(23,rt,2,1,"div",11),o.qZA(),o.TgZ(24,"div",9),o.TgZ(25,"label"),o._uU(26,"End Point"),o.qZA(),o._UZ(27,"input",13),o.YNc(28,ot,2,1,"div",11),o.qZA(),o.TgZ(29,"div",9),o.TgZ(30,"label"),o._uU(31,"Select Image"),o.qZA(),o.TgZ(32,"input",14,15),o.NdJ("change",function(){o.CHM(t);const i=o.MAs(33);return e.processFile(i)}),o.qZA(),o.qZA(),o.YNc(34,lt,5,9,"div",16),o.TgZ(35,"div",9),o.TgZ(36,"label"),o._uU(37,"PICTURE"),o.qZA(),o._UZ(38,"input",17),o.YNc(39,ct,2,1,"div",11),o.qZA(),o.TgZ(40,"span",8),o._UZ(41,"hr"),o.qZA(),o.TgZ(42,"div"),o.TgZ(43,"button",2),o._uU(44," Cancel "),o.qZA(),o._uU(45,"\xa0 "),o.TgZ(46,"button",18),o.YNc(47,pt,1,0,"span",11),o._uU(48," \xa0Save\xa0 "),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()}2&t&&(o.xp6(1),o.Q6J("ngIf",e.isAddMode),o.xp6(1),o.Q6J("ngIf",!e.isAddMode),o.xp6(5),o.Q6J("formGroup",e.form),o.xp6(10),o.Q6J("ngClass",o.VKq(14,Tt,e.submitted&&e.f.BADGE_NAME.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.BADGE_NAME.errors),o.xp6(4),o.Q6J("ngClass",o.VKq(16,Tt,e.submitted&&e.f.START_POINT.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.START_POINT.errors),o.xp6(4),o.Q6J("ngClass",o.VKq(18,Tt,e.submitted&&e.f.END_POINT.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.END_POINT.errors),o.xp6(6),o.Q6J("ngIf",e.selectedFile),o.xp6(4),o.Q6J("ngClass",o.VKq(20,Tt,e.submitted&&e.f.PICTURE.errors)),o.xp6(1),o.Q6J("ngIf",e.submitted&&e.f.PICTURE.errors),o.xp6(7),o.Q6J("disabled",e.loading),o.xp6(1),o.Q6J("ngIf",e.loading))},directives:[n.O5,s.rH,r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,n.mk,r.wV,n.PC],styles:[""]}),t})();const ft=[{path:"point",component:u,children:[{path:"",component:v},{path:"add/:groupid/:groupname",component:X},{path:"edit/:id/:groupid/:groupname",component:X},{path:"addbadge",component:ht},{path:"editbadge/:id",component:ht}]}];let qt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[s.Bz.forChild(ft)],s.Bz]}),t})(),_t=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[n.ez,r.UX,qt]]}),t})()}}]);