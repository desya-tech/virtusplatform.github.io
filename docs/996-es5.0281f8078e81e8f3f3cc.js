!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}(self.webpackChunkappdemo_ng12=self.webpackChunkappdemo_ng12||[]).push([[996],{6996:function(t,n,r){r.r(n),r.d(n,{PointModule:function(){return me}});var o,u=r(2224),s=r(8127),a=r(30),d=r(7147),g=((o=function(){function t(){e(this,t)}return i(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=d.Xpm({type:o,selectors:[["app-point-layout"]],decls:1,vars:0,template:function(e,t){1&e&&d._UZ(0,"router-outlet")},directives:[a.lC],styles:[""]}),o),l=r(7112),c=r(5688),Z=r(4693),p=r.n(Z),f=r(1037),T=r(8054),A=r(514),v=r(1569);function h(e,t){if(1&e&&(d.TgZ(0,"option",25),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.s9C("value",i.GROUP_POINT_ID),d.xp6(1),d.Oqu(i.GROUP_POINT_NAME)}}function q(e,t){1&e&&(d.TgZ(0,"span"),d._UZ(1,"i",32),d.qZA())}function _(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td",26),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"td",26),d.TgZ(5,"p"),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"td",26),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"td",26),d.TgZ(11,"p"),d._uU(12),d.qZA(),d.qZA(),d.TgZ(13,"td",26),d.TgZ(14,"p"),d._uU(15),d.qZA(),d.qZA(),d.TgZ(16,"td",26),d.TgZ(17,"p"),d._uU(18),d.qZA(),d.qZA(),d.TgZ(19,"td"),d.TgZ(20,"div",27),d.TgZ(21,"button",28),d._UZ(22,"i",29),d.qZA(),d._uU(23,"\xa0 "),d.TgZ(24,"button",30),d.NdJ("click",function(){var e=d.CHM(i).$implicit;return d.oxw().confirmBox("delete",e)}),d.YNc(25,q,2,0,"span",31),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var n=t.$implicit,r=t.index,o=d.oxw();d.xp6(3),d.Oqu(r+1),d.xp6(3),d.Oqu(n.POINT_CATEGORY_NAME),d.xp6(3),d.Oqu(n.TABLE_SOURCE),d.xp6(3),d.Oqu(n.TARGET),d.xp6(3),d.Oqu(n.PERCENTAGE),d.xp6(3),d.Oqu(n.GROUP_POINT_NAME),d.xp6(3),d.cQ8("routerLink","edit/",n.POINT_ID,"/",o.group_point_id,"/",o.group_point_name,""),d.xp6(3),d.Q6J("disabled",n.isDeleting),d.xp6(1),d.Q6J("ngIf",!n.isDeleting)}}function b(e,t){if(1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"td",26),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.qZA()),2&e){var i=t.$implicit;d.xp6(3),d.Oqu(i.GROUP_POINT_NAME)}}function m(e,t){1&e&&(d.TgZ(0,"span"),d._UZ(1,"i",32),d.qZA())}function N(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td",26),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"td",26),d.TgZ(5,"p"),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"td",26),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"td",26),d.TgZ(11,"p"),d._uU(12),d.qZA(),d.qZA(),d.TgZ(13,"td"),d.TgZ(14,"div",33),d._UZ(15,"img",34),d.qZA(),d.qZA(),d.TgZ(16,"td"),d.TgZ(17,"div",27),d.TgZ(18,"button",28),d._UZ(19,"i",29),d.qZA(),d._uU(20,"\xa0 "),d.TgZ(21,"button",30),d.NdJ("click",function(){var e=d.CHM(i).$implicit;return d.oxw().confirmBox("deletebadge",e)}),d.YNc(22,m,2,0,"span",31),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var n=t.$implicit,r=t.index,o=d.oxw();d.xp6(3),d.Oqu(r+1),d.xp6(3),d.Oqu(n.BADGE_NAME),d.xp6(3),d.Oqu(n.START_POINT),d.xp6(3),d.Oqu(n.END_POINT),d.xp6(3),d.s9C("src",o.apiurl+n.PICTURE,d.LSH),d.xp6(3),d.MGl("routerLink","editbadge/",n.BADGE_ID,""),d.xp6(3),d.Q6J("disabled",n.isDeleting),d.xp6(1),d.Q6J("ngIf",!n.isDeleting)}}var E=function(){var t=function(){function t(i,n,r){e(this,t),this.pointService=i,this.groupPoint=n,this.alertService=r,this.subs=new c.Y,this.point=null,this.badge=null,this.group_point=null,this.group_point_id=null,this.group_point_name=null,this.apiurl=f.N.apiUrl+"/image/"}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.subs.add(this.pointService.getAllbadge().pipe((0,l.P)()).subscribe(function(t){return e.badge=t})),this.subs.add(this.groupPoint.getAll().subscribe(function(t){e.group_point=t,e.group_point_id=t[0].GROUP_POINT_ID,e.group_point_name=t[0].GROUP_POINT_NAME,e.subs.add(e.pointService.getByGroup(e.group_point_id).pipe((0,l.P)()).subscribe(function(t){return e.point=t}))}))}},{key:"delete",value:function(e){var t=this;this.alertService.loading();var i=this.point.find(function(t){return t.POINT_ID===e.POINT_ID});this.subs.add(this.pointService.delete(e.POINT_ID).pipe((0,l.P)()).subscribe(function(){i.isDeleting=!0,t.point=t.point.filter(function(t){return t.POINT_ID!==e.POINT_ID}),t.alertService.success()},function(e){t.alertService.error(e)}))}},{key:"deletebadge",value:function(e){var t=this;this.alertService.loading();var i=this.badge.find(function(t){return t.BADGE_ID===e.BADGE_ID});this.subs.add(this.pointService.deletebadge(e.BADGE_ID).pipe((0,l.P)()).subscribe(function(){i.isDeleting=!0,t.badge=t.badge.filter(function(t){return t.BADGE_ID!==e.BADGE_ID}),t.alertService.success()},function(e){t.alertService.error(e)}))}},{key:"onSelectClick",value:function(e){var t=this;this.group_point_id=e,this.group_point_name=this.group_point.filter(function(t){return t.GROUP_POINT_ID===parseInt(e)})[0].GROUP_POINT_NAME,this.subs.add(this.pointService.getByGroup(e).pipe((0,l.P)()).subscribe(function(e){return t.point=e}))}},{key:"confirmBox",value:function(e,t){var i,n=this;"delete"==e&&(i=t.POINT_CATEGORY_NAME),"deletebadge"==e&&(i=t.BADGE_NAME),p().fire({title:"Are you sure want to delete?",text:i,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(function(i){i.value&&("delete"==e&&n.delete(t),"deletebadge"==e&&n.deletebadge(t))})}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(T.H),d.Y36(A.T),d.Y36(v.c9))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-point"]],decls:93,vars:6,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],[1,"mr-40"],[1,"row"],[1,"col-lg-9"],[1,"card-style","mb-30"],[1,"title","d-flex","flex-wrap","justify-content-between"],[1,"main-btn","primary-btn","btn-hover","btn-sm",3,"routerLink"],[1,"lni","lni-plus","mr-5"],[1,"left"],[1,"text-medium","mb-10"],[1,"right"],[1,"select-style-1"],[1,"select-position","select-sm"],[1,"light-bg",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"table-wrapper","table-responsive"],[1,"table","striped-table"],[4,"ngFor","ngForOf"],[1,"col-lg-3"],["routerLink","addbadge",1,"main-btn","primary-btn","btn-hover","btn-sm"],[1,"tables-wrapper"],[1,"col-lg-12"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"table"],[3,"value"],[1,"min-width"],[1,"action"],[1,"text-primary",2,"cursor","pointer",3,"routerLink"],[1,"lni","lni-pencil-alt"],[1,"text-danger",3,"disabled","click"],[4,"ngIf"],[1,"lni","lni-trash-can"],[1,"employee-image"],["alt","",3,"src"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"h2",1),d._uU(2,"Point Management"),d.qZA(),d.qZA(),d.TgZ(3,"div",2),d.TgZ(4,"div",3),d.TgZ(5,"div",4),d.TgZ(6,"div",5),d.TgZ(7,"button",6),d._UZ(8,"i",7),d._uU(9,"New Point"),d.qZA(),d.TgZ(10,"div",8),d.TgZ(11,"h6",9),d._uU(12,"Point PerGroup"),d.qZA(),d.qZA(),d.TgZ(13,"div",10),d.TgZ(14,"div",11),d.TgZ(15,"div",12),d.TgZ(16,"select",13),d.NdJ("change",function(e){return t.onSelectClick(e.target.value)}),d.YNc(17,h,2,2,"option",14),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d._UZ(18,"br"),d.TgZ(19,"div",15),d.TgZ(20,"table",16),d.TgZ(21,"thead"),d.TgZ(22,"tr"),d.TgZ(23,"th"),d.TgZ(24,"h6"),d._uU(25,"#"),d.qZA(),d.qZA(),d.TgZ(26,"th"),d.TgZ(27,"h6"),d._uU(28,"Point Name"),d.qZA(),d.qZA(),d.TgZ(29,"th"),d.TgZ(30,"h6"),d._uU(31,"Source Table"),d.qZA(),d.qZA(),d.TgZ(32,"th"),d.TgZ(33,"h6"),d._uU(34,"Target"),d.qZA(),d.qZA(),d.TgZ(35,"th"),d.TgZ(36,"h6"),d._uU(37,"%"),d.qZA(),d.qZA(),d.TgZ(38,"th"),d.TgZ(39,"h6"),d._uU(40,"Group"),d.qZA(),d.qZA(),d.TgZ(41,"th"),d.TgZ(42,"h6"),d._uU(43,"Action"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(44,"tbody"),d.YNc(45,_,26,11,"tr",17),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(46,"div",18),d.TgZ(47,"div",4),d.TgZ(48,"div",15),d.TgZ(49,"table",16),d.TgZ(50,"thead"),d.TgZ(51,"tr"),d.TgZ(52,"th"),d.TgZ(53,"h6"),d._uU(54,"Group Name"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(55,"tbody"),d.YNc(56,b,4,1,"tr",17),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(57,"div",0),d.TgZ(58,"h2",1),d._uU(59,"Badge Management"),d.qZA(),d.TgZ(60,"button",19),d._UZ(61,"i",7),d._uU(62,"New Badge"),d.qZA(),d.qZA(),d.TgZ(63,"div",20),d.TgZ(64,"div",2),d.TgZ(65,"div",21),d.TgZ(66,"div",4),d.TgZ(67,"div",22),d._UZ(68,"div",23),d.qZA(),d.TgZ(69,"div",15),d.TgZ(70,"table",24),d.TgZ(71,"thead"),d.TgZ(72,"tr"),d.TgZ(73,"th"),d.TgZ(74,"h6"),d._uU(75,"#"),d.qZA(),d.qZA(),d.TgZ(76,"th"),d.TgZ(77,"h6"),d._uU(78,"Badge Name"),d.qZA(),d.qZA(),d.TgZ(79,"th"),d.TgZ(80,"h6"),d._uU(81,"Start Point"),d.qZA(),d.qZA(),d.TgZ(82,"th"),d.TgZ(83,"h6"),d._uU(84,"End Point"),d.qZA(),d.qZA(),d.TgZ(85,"th"),d.TgZ(86,"h6"),d._uU(87,"Image"),d.qZA(),d.qZA(),d.TgZ(88,"th"),d.TgZ(89,"h6"),d._uU(90,"Action"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(91,"tbody"),d.YNc(92,N,23,8,"tr",17),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.hYB("routerLink","add/",t.group_point_id,"/",t.group_point_name,""),d.xp6(10),d.Q6J("ngForOf",t.group_point),d.xp6(28),d.Q6J("ngForOf",t.point),d.xp6(11),d.Q6J("ngForOf",t.group_point),d.xp6(36),d.Q6J("ngForOf",t.badge))},directives:[a.rH,u.sg,s.YN,s.Kr,u.O5],styles:[""]}),t}(),I=r(7755);function U(e,t){1&e&&(d.TgZ(0,"h2",20),d._uU(1,"New Point"),d.qZA())}function P(e,t){1&e&&(d.TgZ(0,"h2",20),d._uU(1,"Edit Point"),d.qZA())}function x(e,t){1&e&&(d.TgZ(0,"div"),d._uU(1,"*group point required"),d.qZA())}function O(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,x,2,0,"div",12),d.qZA()),2&e){var i=d.oxw(2);d.xp6(1),d.Q6J("ngIf",i.f.GROUP_POINT_NAME.errors.required)}}var y=function(e){return{"is-invalid":e}};function C(e,t){if(1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label"),d._uU(2,"Group Point"),d.qZA(),d._UZ(3,"input",21),d.YNc(4,O,2,1,"div",12),d.qZA()),2&e){var i=d.oxw();d.xp6(3),d.Q6J("ngClass",d.VKq(2,y,i.submitted&&i.f.GROUP_POINT_NAME.errors)),d.xp6(1),d.Q6J("ngIf",i.submitted&&i.f.GROUP_POINT_NAME.errors)}}function S(e,t){if(1&e&&(d.TgZ(0,"option",26),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.s9C("value",i.GROUP_POINT_ID),d.xp6(1),d.Oqu(i.GROUP_POINT_NAME)}}function Y(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*group point required"),d.qZA())}function R(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,Y,2,0,"div",27),d.qZA()),2&e){var i=d.oxw(2);d.xp6(1),d.Q6J("ngIf",i.f.GROUP_POINT_ID.errors.required)}}function G(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",22),d.TgZ(1,"label"),d._uU(2,"Group Point"),d.qZA(),d.TgZ(3,"div",23),d.TgZ(4,"select",24),d.NdJ("change",function(e){return d.CHM(i),d.oxw().onSelectClick(e.target.value)}),d.YNc(5,S,2,2,"option",25),d.qZA(),d.qZA(),d.YNc(6,R,2,1,"div",12),d.qZA()}if(2&e){var n=d.oxw();d.xp6(4),d.Q6J("ngClass",d.VKq(3,y,n.submitted&&n.f.GROUP_POINT_ID.errors)),d.xp6(1),d.Q6J("ngForOf",n.group_point),d.xp6(1),d.Q6J("ngIf",n.submitted&&n.f.GROUP_POINT_ID.errors)}}function J(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*Point Name required"),d.qZA())}function w(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,J,2,0,"div",27),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.POINT_CATEGORY_NAME.errors.required)}}function Q(e,t){1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label"),d._uU(2,"Source Table"),d.qZA(),d._UZ(3,"input",29),d.qZA())}function k(e,t){if(1&e&&(d.TgZ(0,"option",26),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.s9C("value",i.TABLE_NAME),d.xp6(1),d.Oqu(i.TABLE_NAME)}}function M(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*table required"),d.qZA())}function B(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,M,2,0,"div",27),d.qZA()),2&e){var i=d.oxw(2);d.xp6(1),d.Q6J("ngIf",i.f.TABLE_SOURCE.errors.required)}}function D(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",22),d.TgZ(1,"label"),d._uU(2,"Source Table"),d.qZA(),d.TgZ(3,"div",23),d.TgZ(4,"select",30),d.NdJ("change",function(e){return d.CHM(i),d.oxw().onSelectClickTable(e.target.value)}),d.YNc(5,k,2,2,"option",25),d.qZA(),d.qZA(),d.YNc(6,B,2,1,"div",12),d.qZA()}if(2&e){var n=d.oxw();d.xp6(4),d.Q6J("ngClass",d.VKq(3,y,n.submitted&&n.f.TABLE_SOURCE.errors)),d.xp6(1),d.Q6J("ngForOf",n.gettable),d.xp6(1),d.Q6J("ngIf",n.submitted&&n.f.TABLE_SOURCE.errors)}}function F(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*target required"),d.qZA())}function L(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,F,2,0,"div",27),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.TARGET.errors.required)}}function V(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*required"),d.qZA())}function K(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*max 100"),d.qZA())}function H(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,V,2,0,"div",27),d.YNc(2,K,2,0,"div",27),d.qZA()),2&e){var i=d.oxw(2);d.xp6(1),d.Q6J("ngIf",i.f.PERCENTAGE.errors.required),d.xp6(1),d.Q6J("ngIf",i.f.PERCENTAGE.errors.max)}}function $(e,t){1&e&&(d.TgZ(0,"div",28),d._uU(1,"*melebihi total Percentage"),d.qZA())}function j(e,t){if(1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label"),d._uU(2,"Percentage"),d.qZA(),d._UZ(3,"input",31),d.YNc(4,H,3,2,"div",12),d.YNc(5,$,2,0,"div",27),d.qZA()),2&e){var i=d.oxw();d.xp6(3),d.Q6J("ngClass",d.VKq(3,y,i.submitted&&i.f.PERCENTAGE.errors)),d.xp6(1),d.Q6J("ngIf",i.submitted&&i.f.PERCENTAGE.errors),d.xp6(1),d.Q6J("ngIf",i.pass)}}function X(e,t){1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"label"),d._uU(2,"Percentage"),d.qZA(),d._UZ(3,"input",32),d.qZA())}function z(e,t){1&e&&d._UZ(0,"span")}function W(e,t){if(1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"td",33),d.TgZ(2,"p"),d._uU(3),d.qZA(),d.qZA(),d.TgZ(4,"td",33),d.TgZ(5,"p"),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"td",33),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"td",33),d.TgZ(11,"p"),d._uU(12),d.qZA(),d.qZA(),d.qZA()),2&e){var i=t.$implicit;d.xp6(3),d.Oqu(i.POINT_CATEGORY_NAME),d.xp6(3),d.Oqu(i.TABLE_SOURCE),d.xp6(3),d.Oqu(i.MAX_POINT),d.xp6(3),d.hij("",i.PERCENTAGE," %")}}var ee=function(){var t=function(){function t(i,n,r,o,u,s,a){e(this,t),this.formBuilder=i,this.route=n,this.router=r,this.pointService=o,this.alertService=u,this.groupPoint=s,this.queryviewService=a,this.subs=new c.Y,this.loading=!1,this.submitted=!1,this.data=null,this.gettable=null,this.point=null,this.totalpercentage=0,this.pass=!1,this.temp=0,this.group_point=null,this.groupid=null,this.groupname=null,this.queryviewdata=null,this.type_queryview=null}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.id=this.route.snapshot.params.id,this.groupid=this.route.snapshot.params.groupid,this.groupname=this.route.snapshot.params.groupname,this.isAddMode=!this.id,this.form=this.formBuilder.group({POINT_CATEGORY_NAME:["",s.kI.required],TARGET:["",s.kI.required],PERCENTAGE:["",s.kI.required],TABLE_SOURCE:["",s.kI.required],GROUP_POINT_ID:[this.groupid],GROUP_POINT_NAME:[this.groupname]}),this.subs.add(this.queryviewService.getAll().subscribe(function(t){return e.queryviewdata=t})),this.isAddMode||this.subs.add(this.pointService.getById(this.id).pipe((0,l.P)()).subscribe(function(t){e.form.patchValue(t),e.temp=parseInt(t.PERCENTAGE),e.type_queryview=e.queryviewdata.find(function(e){return e.QUERY_VIEW_NAME==t.TABLE_SOURCE}).TYPE_ID})),this.subs.add(this.pointService.getAlltable(this.groupid).subscribe(function(t){return e.gettable=t})),this.subs.add(this.pointService.getByGroup(this.groupid).pipe((0,l.P)()).subscribe(function(t){void 0===t||0==t.length?e.point=null:(e.totalpercentage=t.map(function(e){return parseInt(e.PERCENTAGE)}).reduce(function(e,t){return e+t}),e.point=t)})),this.subs.add(this.groupPoint.getAll().subscribe(function(t){return e.group_point=t}))}},{key:"f",get:function(){return this.form.controls}},{key:"onSubmit",value:function(){if(this.isAddMode){if(this.totalpercentage+this.form.value.PERCENTAGE>=100)return void(this.pass=!0);this.pass=!1}else{if(this.totalpercentage-this.temp+parseInt(this.form.value.PERCENTAGE)>=100)return void(this.pass=!0);this.pass=!1}this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.create():this.update())}},{key:"create",value:function(){var e=this;this.alertService.loading(),this.subs.add(this.pointService.create(this.form.value).pipe((0,l.P)()).subscribe({next:function(){e.alertService.success(),e.router.navigate(["/point"],{relativeTo:e.route})},error:function(t){e.alertService.error(t),e.loading=!1}}))}},{key:"update",value:function(){var e=this;this.alertService.loading(),this.subs.add(this.pointService.update(this.id,this.form.value).pipe((0,l.P)()).subscribe({next:function(){e.alertService.success(),e.router.navigate(["/point"],{relativeTo:e.route})},error:function(t){e.alertService.error(t),e.loading=!1}}))}},{key:"onSelectClick",value:function(e){var t=this,i=this.group_point.filter(function(t){return t.GROUP_POINT_ID===parseInt(e)})[0].GROUP_POINT_NAME;this.form.get("GROUP_POINT_NAME").setValue(i),this.subs.add(this.pointService.getAlltable(e).subscribe(function(e){return t.gettable=e})),this.subs.add(this.pointService.getByGroup(e).pipe((0,l.P)()).subscribe(function(e){void 0===e||0==e.length?(t.point=null,t.form.get("TABLE_SOURCE").setValue("")):(t.totalpercentage=e.map(function(e){return parseInt(e.PERCENTAGE)}).reduce(function(e,t){return e+t}),t.point=e)}))}},{key:"onSelectClickTable",value:function(e){this.type_queryview=this.queryviewdata.find(function(t){return t.QUERY_VIEW_NAME==e}).TYPE_ID,2==parseInt(this.type_queryview)?this.form.get("PERCENTAGE").setValue("0"):this.form.get("PERCENTAGE").setValue("")}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(s.qu),d.Y36(a.gz),d.Y36(a.F0),d.Y36(T.H),d.Y36(v.c9),d.Y36(A.T),d.Y36(I.b))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-point-add-edit"]],decls:57,vars:21,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],["class","mr-40",4,"ngIf"],["routerLink","/point",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[1,"col-lg-6"],[1,"card-style","mb-30"],[3,"formGroup","ngSubmit"],["class","input-style-1",4,"ngIf"],["class","select-style-1",4,"ngIf"],[1,"input-style-1"],["type","text","formControlName","POINT_CATEGORY_NAME",3,"ngClass"],[4,"ngIf"],["type","number","formControlName","TARGET","min","0",3,"ngClass"],[1,"divider"],[1,"main-btn","primary-btn","rounded-btn","btn-hover",3,"disabled"],[1,"mb-10"],[1,"table-wrapper","table-responsive"],[1,"table","striped-table"],[4,"ngFor","ngForOf"],[1,"mr-40"],["type","text","formControlName","GROUP_POINT_NAME","disabled","",3,"ngClass"],[1,"select-style-1"],[1,"select-position"],["formControlName","GROUP_POINT_ID",3,"ngClass","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["style","color:red",4,"ngIf"],[2,"color","red"],["type","text","formControlName","TABLE_SOURCE","disabled",""],["formControlName","TABLE_SOURCE",3,"ngClass","change"],["type","number","formControlName","PERCENTAGE","min","0","max","100",3,"ngClass"],["type","number","formControlName","PERCENTAGE","min","0","max","100","disabled",""],[1,"min-width"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.YNc(1,U,2,0,"h2",1),d.YNc(2,P,2,0,"h2",1),d.TgZ(3,"button",2),d._UZ(4,"i",3),d._uU(5,"Back"),d.qZA(),d.qZA(),d.TgZ(6,"div",4),d.TgZ(7,"div",5),d.TgZ(8,"div",6),d.TgZ(9,"form",7),d.NdJ("ngSubmit",function(){return t.onSubmit()}),d.YNc(10,C,5,4,"div",8),d.YNc(11,G,7,5,"div",9),d.TgZ(12,"div",10),d.TgZ(13,"label"),d._uU(14,"Point Name"),d.qZA(),d._UZ(15,"input",11),d.YNc(16,w,2,1,"div",12),d.qZA(),d.YNc(17,Q,4,0,"div",8),d.YNc(18,D,7,5,"div",9),d.TgZ(19,"div",10),d.TgZ(20,"label"),d._uU(21,"Target Point"),d.qZA(),d._UZ(22,"input",13),d.YNc(23,L,2,1,"div",12),d.qZA(),d.YNc(24,j,6,5,"div",8),d.YNc(25,X,4,0,"div",8),d.TgZ(26,"span",14),d._UZ(27,"hr"),d.qZA(),d.TgZ(28,"div"),d.TgZ(29,"button",2),d._uU(30," Cancel "),d.qZA(),d._uU(31,"\xa0 "),d.TgZ(32,"button",15),d.YNc(33,z,1,0,"span",12),d._uU(34," \xa0Save\xa0 "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(35,"div",5),d.TgZ(36,"div",6),d.TgZ(37,"h6",16),d._uU(38),d.qZA(),d.TgZ(39,"div",17),d.TgZ(40,"table",18),d.TgZ(41,"thead"),d.TgZ(42,"tr"),d.TgZ(43,"th"),d.TgZ(44,"h6"),d._uU(45,"Point Name"),d.qZA(),d.qZA(),d.TgZ(46,"th"),d.TgZ(47,"h6"),d._uU(48,"Source Table"),d.qZA(),d.qZA(),d.TgZ(49,"th"),d.TgZ(50,"h6"),d._uU(51,"Max Point"),d.qZA(),d.qZA(),d.TgZ(52,"th"),d.TgZ(53,"h6"),d._uU(54,"Percent %"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(55,"tbody"),d.YNc(56,W,13,4,"tr",19),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngIf",t.isAddMode),d.xp6(1),d.Q6J("ngIf",!t.isAddMode),d.xp6(7),d.Q6J("formGroup",t.form),d.xp6(1),d.Q6J("ngIf",!t.isAddMode),d.xp6(1),d.Q6J("ngIf",t.isAddMode),d.xp6(4),d.Q6J("ngClass",d.VKq(17,y,t.submitted&&t.f.POINT_CATEGORY_NAME.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.POINT_CATEGORY_NAME.errors),d.xp6(1),d.Q6J("ngIf",!t.isAddMode),d.xp6(1),d.Q6J("ngIf",t.isAddMode),d.xp6(4),d.Q6J("ngClass",d.VKq(19,y,t.submitted&&t.f.TARGET.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.TARGET.errors),d.xp6(1),d.Q6J("ngIf",1===t.type_queryview),d.xp6(1),d.Q6J("ngIf",2===t.type_queryview),d.xp6(7),d.Q6J("disabled",t.loading),d.xp6(1),d.Q6J("ngIf",t.loading),d.xp6(5),d.hij("Total Percentage : ",t.totalpercentage,"%"),d.xp6(18),d.Q6J("ngForOf",t.point))},directives:[u.O5,a.rH,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,u.mk,s.wV,s.qQ,u.sg,s.EJ,s.YN,s.Kr,s.Fd],styles:[""]}),t}(),te=r(3546);function ie(e,t){1&e&&(d.TgZ(0,"h2",19),d._uU(1,"New Badge"),d.qZA())}function ne(e,t){1&e&&(d.TgZ(0,"h2",19),d._uU(1,"Edit Badge"),d.qZA())}function re(e,t){1&e&&(d.TgZ(0,"div",21),d._uU(1,"*Badge Name required"),d.qZA())}function oe(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,re,2,0,"div",20),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.BADGE_NAME.errors.required)}}function ue(e,t){1&e&&(d.TgZ(0,"div",21),d._uU(1,"*Start Point required"),d.qZA())}function se(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,ue,2,0,"div",20),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.START_POINT.errors.required)}}function ae(e,t){1&e&&(d.TgZ(0,"div",21),d._uU(1,"*End Point required"),d.qZA())}function de(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,ae,2,0,"div",20),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.END_POINT.errors.required)}}function ge(e,t){1&e&&(d.TgZ(0,"div",27),d._UZ(1,"div",28),d.qZA())}function le(e,t){1&e&&(d.TgZ(0,"div",29),d._uU(1," Image Uploaded Succesfuly!"),d.qZA())}function ce(e,t){1&e&&(d.TgZ(0,"div",30),d._uU(1," Image Upload Failed!"),d.qZA())}var Ze=function(e){return{"background-image":e}};function pe(e,t){if(1&e&&(d.TgZ(0,"div",22),d._UZ(1,"div",23),d.YNc(2,ge,2,0,"div",24),d.YNc(3,le,2,0,"div",25),d.YNc(4,ce,2,0,"div",26),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Gre("img-preview","fail"===i.selectedFile.status?"-error":"",""),d.Q6J("ngStyle",d.VKq(7,Ze,"url("+i.selectedFile.src+")")),d.xp6(1),d.Q6J("ngIf",i.selectedFile.pending),d.xp6(1),d.Q6J("ngIf","ok"===i.selectedFile.status),d.xp6(1),d.Q6J("ngIf","fail"===i.selectedFile.status)}}function fe(e,t){1&e&&(d.TgZ(0,"div",21),d._uU(1,"*Picture required"),d.qZA())}function Te(e,t){if(1&e&&(d.TgZ(0,"div"),d.YNc(1,fe,2,0,"div",20),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.Q6J("ngIf",i.f.PICTURE.errors.required)}}function Ae(e,t){1&e&&d._UZ(0,"span")}var ve=function(e){return{"is-invalid":e}},he=function t(i,n){e(this,t),this.src=i,this.file=n,this.pending=!1,this.status="init"},qe=function(){var t=function(){function t(i,n,r,o,u,s){e(this,t),this.formBuilder=i,this.route=n,this.router=r,this.pointService=o,this.alertService=u,this.imageService=s,this.subs=new c.Y,this.loading=!1,this.submitted=!1,this.data=null,this.apiurl=f.N.apiUrl,this.filenameimage=null}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({BADGE_NAME:["",s.kI.required],START_POINT:["",s.kI.required],END_POINT:["",s.kI.required],PICTURE:[""]}),this.isAddMode||this.subs.add(this.pointService.getByIdbadge(this.id).pipe((0,l.P)()).subscribe(function(t){return e.form.patchValue(t)}))}},{key:"f",get:function(){return this.form.controls}},{key:"onSubmit",value:function(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.create():this.update())}},{key:"create",value:function(){var e=this;this.alertService.loading(),this.subs.add(this.pointService.createbadge(this.form.value).pipe((0,l.P)()).subscribe({next:function(){e.alertService.success(),e.router.navigate(["../"],{relativeTo:e.route})},error:function(t){e.alertService.error(t),e.loading=!1}}))}},{key:"update",value:function(){var e=this;this.alertService.loading(),this.subs.add(this.pointService.updatebadge(this.id,this.form.value).pipe((0,l.P)()).subscribe({next:function(){e.alertService.success(),e.router.navigate(["../../"],{relativeTo:e.route})},error:function(t){e.alertService.error(t),e.loading=!1}}))}},{key:"onSuccess",value:function(){this.selectedFile.pending=!1,this.selectedFile.status="ok"}},{key:"onError",value:function(){this.selectedFile.pending=!1,this.selectedFile.status="fail",this.selectedFile.src=""}},{key:"processFile",value:function(e){var t=this,i=e.files[0],n=new FileReader;this.form.value.PICTURE&&this.imageService.deleteImage(this.form.value.PICTURE).pipe((0,l.P)()).subscribe(),n.addEventListener("load",function(e){t.selectedFile=new he(e.target.result,i),t.imageService.uploadImage(t.selectedFile.file).subscribe(function(e){t.form.get("PICTURE").setValue(e.filename),t.onSuccess()},function(e){t.onError()})}),n.readAsDataURL(i)}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(s.qu),d.Y36(a.gz),d.Y36(a.F0),d.Y36(T.H),d.Y36(v.c9),d.Y36(te.C))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-badge-add-edit"]],decls:49,vars:22,consts:[[1,"title","d-flex","align-items-center","flex-wrap","mb-30"],["class","mr-40",4,"ngIf"],["routerLink","/point",1,"main-btn","primary-btn-outline","rounded-btn","btn-hover"],[1,"lni","lni-chevron-left","mr-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"col-lg-6"],[1,"card-style","mb-30"],[1,"divider"],[1,"input-style-1"],["type","text","formControlName","BADGE_NAME",3,"ngClass"],[4,"ngIf"],["type","number","formControlName","START_POINT",3,"ngClass"],["type","number","formControlName","END_POINT",3,"ngClass"],["type","file","accept","image/*",3,"change"],["imageInput",""],["class","img-preview-container",4,"ngIf"],["type","text","formControlName","PICTURE","disabled","",3,"ngClass"],[1,"main-btn","primary-btn","rounded-btn","btn-hover",3,"disabled"],[1,"mr-40"],["style","color:red",4,"ngIf"],[2,"color","red"],[1,"img-preview-container"],[3,"ngStyle"],["class","img-loading-overlay",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"img-loading-overlay"],[1,"img-spinning-circle"],[1,"alert","alert-success"],[1,"alert","alert-danger"]],template:function(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",0),d.YNc(1,ie,2,0,"h2",1),d.YNc(2,ne,2,0,"h2",1),d.TgZ(3,"button",2),d._UZ(4,"i",3),d._uU(5,"Back"),d.qZA(),d.qZA(),d.TgZ(6,"div",4),d.TgZ(7,"form",5),d.NdJ("ngSubmit",function(){return t.onSubmit()}),d.TgZ(8,"div",6),d.TgZ(9,"div",7),d.TgZ(10,"h5"),d._uU(11,"Badge Description"),d.qZA(),d.TgZ(12,"span",8),d._UZ(13,"hr"),d.qZA(),d.TgZ(14,"div",9),d.TgZ(15,"label"),d._uU(16,"Badge Name"),d.qZA(),d._UZ(17,"input",10),d.YNc(18,oe,2,1,"div",11),d.qZA(),d.TgZ(19,"div",9),d.TgZ(20,"label"),d._uU(21,"Start Point"),d.qZA(),d._UZ(22,"input",12),d.YNc(23,se,2,1,"div",11),d.qZA(),d.TgZ(24,"div",9),d.TgZ(25,"label"),d._uU(26,"End Point"),d.qZA(),d._UZ(27,"input",13),d.YNc(28,de,2,1,"div",11),d.qZA(),d.TgZ(29,"div",9),d.TgZ(30,"label"),d._uU(31,"Select Image"),d.qZA(),d.TgZ(32,"input",14,15),d.NdJ("change",function(){d.CHM(i);var e=d.MAs(33);return t.processFile(e)}),d.qZA(),d.qZA(),d.YNc(34,pe,5,9,"div",16),d.TgZ(35,"div",9),d.TgZ(36,"label"),d._uU(37,"PICTURE"),d.qZA(),d._UZ(38,"input",17),d.YNc(39,Te,2,1,"div",11),d.qZA(),d.TgZ(40,"span",8),d._UZ(41,"hr"),d.qZA(),d.TgZ(42,"div"),d.TgZ(43,"button",2),d._uU(44," Cancel "),d.qZA(),d._uU(45,"\xa0 "),d.TgZ(46,"button",18),d.YNc(47,Ae,1,0,"span",11),d._uU(48," \xa0Save\xa0 "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(1),d.Q6J("ngIf",t.isAddMode),d.xp6(1),d.Q6J("ngIf",!t.isAddMode),d.xp6(5),d.Q6J("formGroup",t.form),d.xp6(10),d.Q6J("ngClass",d.VKq(14,ve,t.submitted&&t.f.BADGE_NAME.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.BADGE_NAME.errors),d.xp6(4),d.Q6J("ngClass",d.VKq(16,ve,t.submitted&&t.f.START_POINT.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.START_POINT.errors),d.xp6(4),d.Q6J("ngClass",d.VKq(18,ve,t.submitted&&t.f.END_POINT.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.END_POINT.errors),d.xp6(6),d.Q6J("ngIf",t.selectedFile),d.xp6(4),d.Q6J("ngClass",d.VKq(20,ve,t.submitted&&t.f.PICTURE.errors)),d.xp6(1),d.Q6J("ngIf",t.submitted&&t.f.PICTURE.errors),d.xp6(7),d.Q6J("disabled",t.loading),d.xp6(1),d.Q6J("ngIf",t.loading))},directives:[u.O5,a.rH,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,u.mk,s.wV,u.PC],styles:[""]}),t}(),_e=[{path:"point",component:g,children:[{path:"",component:E},{path:"add/:groupid/:groupname",component:ee},{path:"edit/:id/:groupid/:groupname",component:ee},{path:"addbadge",component:qe},{path:"editbadge/:id",component:qe}]}],be=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[a.Bz.forChild(_e)],a.Bz]}),t}(),me=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[u.ez,s.UX,be]]}),t}()}}])}();